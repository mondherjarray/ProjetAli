!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("html2canvas"),require("xlsx"),require("html2pdf.js")):"function"==typeof define&&define.amd?define("ngx-export-as",["exports","@angular/core","rxjs","html2canvas","xlsx","html2pdf.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-export-as"]={},e.ng.core,e.rxjs,e.html2canvas,e.XLSX,e.html2pdf)}(this,(function(e,t,n,o,r,a){"use strict";function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=l(o),s=l(a);window.html2canvas=i.default;var d=function(){function e(){}return e.prototype.get=function(e){var t="get"+e.type.toUpperCase();return this[t]?this[t](e):new n.Observable((function(e){e.error("Export type is not supported.")}))},e.prototype.save=function(e,t){return e.download=!0,e.fileName=t+"."+e.type,this.get(e)},e.prototype.contentToBlob=function(e){return new n.Observable((function(t){for(var n=e.split(","),o=n[0].match(/:(.*?);/)[1],r=atob(n[1]),a=r.length,l=new Uint8Array(a);a--;)l[a]=r.charCodeAt(a);t.next(new Blob([l],{type:o})),t.complete()}))},e.prototype.removeFileTypeFromBase64=function(e){return/^data:[^]*;base64,/g[Symbol.replace](e,"")},e.prototype.addFileTypeToBase64=function(e,t){return"data:"+t+";base64,"+e},e.prototype.downloadFromDataURL=function(e,t){var n=this;this.contentToBlob(t).subscribe((function(t){n.downloadFromBlob(t,e)}))},e.prototype.downloadFromBlob=function(e,t){var n=window.URL.createObjectURL(e);if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var o=document.createElement("a");o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.href=n,o.click(),document.body.removeChild(o)}},e.prototype.getPDF=function(e){var t=this;return new n.Observable((function(n){e.options||(e.options={}),e.options.filename=e.fileName;var o=document.getElementById(e.elementIdOrContent),r=s.default().set(e.options).from(o||e.elementIdOrContent),a=e.download,l=e.options.pdfCallbackFn;a?(l?t.applyPdfCallbackFn(r,l).save():r.save(),n.next(),n.complete()):l?t.applyPdfCallbackFn(r,l).outputPdf("datauristring").then((function(e){n.next(e),n.complete()})):r.outputPdf("datauristring").then((function(e){n.next(e),n.complete()}))}))},e.prototype.applyPdfCallbackFn=function(e,t){return e.toPdf().get("pdf").then((function(e){t(e)}))},e.prototype.getPNG=function(e){var t=this;return new n.Observable((function(n){var o=document.getElementById(e.elementIdOrContent);i.default(o,e.options).then((function(o){var r=o.toDataURL("image/PNG");"png"===e.type&&e.download?(t.downloadFromDataURL(e.fileName,r),n.next()):n.next(r),n.complete()}),(function(e){n.error(e)}))}))},e.prototype.getCSV=function(e){var t=this;return new n.Observable((function(n){for(var o=[],r=document.getElementById(e.elementIdOrContent).querySelectorAll("table tr"),a=0;a<r.length;a++){for(var l=[],i=r[a].querySelectorAll("td, th"),s=0;s<i.length;s++){var d=i[s];l.push(d.innerText)}o.push(l.join(","))}var p="data:text/csv;base64,"+t.btoa(o.join("\n"));e.download?(t.downloadFromDataURL(e.fileName,p),n.next()):n.next(p),n.complete()}))},e.prototype.getTXT=function(e){var t=e.fileName.split(".");return e.fileName=t[0]+".txt",this.getCSV(e)},e.prototype.getXLS=function(e){var t=this;return new n.Observable((function(n){var o=document.getElementById(e.elementIdOrContent),a=r.utils.table_to_sheet(o,e.options),l=r.utils.book_new();r.utils.book_append_sheet(l,a,e.fileName);var i="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+r.write(l,{type:"base64"});e.download?(t.downloadFromDataURL(e.fileName,i),n.next()):n.next(i),n.complete()}))},e.prototype.getXLSX=function(e){return this.getXLS(e)},e.prototype.getJSON=function(e){var t=this;return new n.Observable((function(n){for(var o=[],r=[],a=document.getElementById(e.elementIdOrContent),l=0;l<a.rows[0].cells.length;l++)r[l]=a.rows[0].cells[l].innerHTML.toLowerCase().replace(/ /gi,"");for(var i=1;i<a.rows.length;i++){for(var s=a.rows[i],d={},p=0;p<s.cells.length;p++)d[r[p]]=s.cells[p].innerHTML;o.push(d)}var c=JSON.stringify(o),u="data:text/json;base64,"+t.btoa(c);e.download?(t.downloadFromDataURL(e.fileName,u),n.next()):n.next(o),n.complete()}))},e.prototype.getXML=function(e){var t=this;return new n.Observable((function(n){for(var o='<?xml version="1.0" encoding="UTF-8"?><Root><Classes>',r=document.getElementById(e.elementIdOrContent).getElementsByTagName("tr"),a=0;a<r.length;a++){var l=r[a];if(l.cells.length>0){o+='<Class name="'+l.cells[0].textContent+'">\n';for(var i=1;i<l.cells.length;++i)o+="\t<data>"+l.cells[i].textContent+"</data>\n";o+="</Class>\n"}}o+="</Classes></Root>";var s="data:text/xml;base64,"+t.btoa(o);e.download?(t.downloadFromDataURL(e.fileName,s),n.next()):n.next(s),n.complete()}))},e.prototype.btoa=function(e){return btoa(unescape(encodeURIComponent(e)))},e}();d.decorators=[{type:t.Injectable}],d.ctorParameters=function(){return[]};var p=function(){};p.decorators=[{type:t.NgModule,args:[{providers:[d]}]}],e.ExportAsModule=p,e.ExportAsService=d,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-export-as.umd.min.js.map